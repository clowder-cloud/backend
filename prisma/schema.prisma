generator client {
  provider = "prisma-client-js"
}

generator json {
  provider = "prisma-json-types-generator"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String @unique @default(cuid())
  username String @unique

  devices Device[]
  cats    Cat[]

  updated_at DateTime @updatedAt
  created_at DateTime @default(now())
  deleted_at DateTime?
}

model Device {
  id String @unique @default(cuid())

  name String @default("GPS Device")
  uuid String @unique @default(uuid())

  owner    User?   @relation(fields: [owner_id], references: [id])
  owner_id String?

  cat Cat?

  last_pulse_at    DateTime?
  /// [LastLocation]
  last_location    Json      @default("{}")
  /// [LocationHistory]
  location_history Json      @default("[]")

  updated_at DateTime @updatedAt
  created_at DateTime @default(now())
  deleted_at DateTime?
}

model Cat {
  id String @unique @default(cuid())

  name        String @default("Cat")
  description String @default("Meow meow. Meow meow? Meow!")
  picture_url String @default("https://c8.alamy.com/comp/DBTJAD/a-closeup-picture-of-a-cats-face-on-a-white-background-DBTJAD.jpg")

  device    Device? @relation(fields: [device_id], references: [id])
  device_id String? @unique
  owner     User?  @relation(fields: [owner_id], references: [id])
  owner_id  String

  updated_at DateTime @updatedAt
  created_at DateTime @default(now())
  deleted_at DateTime?
}
